/*!
****************************************************************************************************
* 文件名称：drvmanager-led.c
* 功能简介：该文件是驱动管理器LED驱动模块的实现文件
* 文件作者：HQHP
* 创建日期：2020-08-21
* 版权声明：All Rights Reserved.
****************************************************************************************************
*/
#include "drvmanager/drvmanager.h"
#include "stm32f4xx.h"

/*!
****************************************************************************************************
* 常量定义
****************************************************************************************************
*/

/*!
****************************************************************************************************
* 类型定义
****************************************************************************************************
*/

/*!
****************************************************************************************************
* 全局变量
****************************************************************************************************
*/
unsigned char LED_Flip_Flag;
/*!
****************************************************************************************************
* 本地声明
****************************************************************************************************
*/
static void DRVMGR_LEDHwInit(void);

/*!
****************************************************************************************************
* 接口函数
****************************************************************************************************
*/
/*!
****************************************************************************************************
* 功能描述：该方法用于初始化LED驱动模块
* 注意事项：在调用该模块其他API前，必须先调用该模块
* 输入参数：NA
* 输出参数：NA
* 返回参数：NA
****************************************************************************************************
*/
void DRVMGR_LEDInit(void)
{
	DRVMGR_LEDHwInit();
}

/*!
****************************************************************************************************
* 功能描述：该方法用于处理LED驱动模块中需要周期处理的事务
* 注意事项：NA
* 输入参数：NA
* 输出参数：NA
* 返回参数：NA
****************************************************************************************************
*/
void DRVMGR_LEDHandle(void)
{
	/*! NOTHING TO DO */
}

/*!
****************************************************************************************************
* 功能描述：该方法用于点亮指定的LED指示灯
* 注意事项：调用该方法前必须调用初始化函数
* 输入参数：idx -- 指示灯索引
*				@arg LED_ID_RUN
* 输出参数：NA
* 返回参数：NA
****************************************************************************************************
*/
void DRVMGR_LEDTurnOn(void)
{
	GPIO_SetBits(GPIOF, GPIO_Pin_4);//亮灯
}

/*!
****************************************************************************************************
* 功能描述：该方法用于熄灭指定的LED指示灯
* 注意事项：调用该方法前必须调用初始化函数
* 输入参数：idx -- 指示灯索引
*				@arg LED_ID_RUN
* 输出参数：NA
* 返回参数：NA
****************************************************************************************************
*/
void DRVMGR_LEDTurnOff(void)
{
	GPIO_ResetBits(GPIOF, GPIO_Pin_4);//灭灯
}

/*!
****************************************************************************************************
* 功能描述：该方法用于闪烁指定的LED指示灯
* 注意事项：调用该方法前必须调用初始化函数
* 输入参数：idx -- 指示灯索引
*				@arg LED_ID_RUN
* 输出参数：NA
* 返回参数：NA
****************************************************************************************************
*/
void DRVMGR_LEDTwinkle(void)
{
	GPIO_ToggleBits(GPIOF, GPIO_Pin_4);
}

/*!
****************************************************************************************************
* 本地函数
****************************************************************************************************
*/
/*!
****************************************************************************************************
* 功能描述：该方法用于初始化LED连接的GPIO引脚
* 注意事项：默认所有LED处于熄灭状态
* 输入参数：NA
* 输出参数：NA
* 返回参数：NA
****************************************************************************************************
*/
static void DRVMGR_LEDHwInit(void)
{
	GPIO_InitTypeDef GPIO_InitStructure;

	// MCU_RUN --> PF4
	GPIO_InitStructure.GPIO_Pin	  = GPIO_Pin_4;
	GPIO_InitStructure.GPIO_Mode  = GPIO_Mode_OUT;
	GPIO_InitStructure.GPIO_PuPd  = GPIO_PuPd_UP;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_25MHz;
	RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOF, ENABLE);
	GPIO_Init(GPIOF, &GPIO_InitStructure);

	GPIO_ResetBits(GPIOF, GPIO_Pin_4);//灭灯
}
